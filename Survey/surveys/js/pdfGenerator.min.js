$(function () { function e(a, b, c) { var d = new jsPDF("p", "pt", "a4"); document.body.appendChild(a); var f = 590, g = 842, h = a.height * f / a.width, i = h, j = 10, k = a.toDataURL("image/png"); for (d.addImage(k, "JPEG", 0, j, f, h), i -= g; i >= 0;) j = i - h, d.addPage(), d.addImage(k, "JPEG", 0, j, f, h), i -= g; d.save("dashboard_" + (new Date).getTime() + ".pdf"), document.body.removeChild(a) } function f() { html2canvas(d.get(0), { onrendered: function (a) { e(a, "Dashboard", function () { }) } }) } var a = $(".screenShotTempCanvas"), d = (a.width(), $("#dashboard-content")); $("#toPdf").click(function () { $("#current-date").text(new Date), $("body").scrollTop(10), d.find("svg").each(function () { var a, b; $.each($(this).find("[style*=em]"), function (a, b) { $(this).css("font-size", getStyle(b, "font-size")) }), a = document.createElement("canvas"), a.className = "screenShotTempCanvas", b = (new XMLSerializer).serializeToString(this), b = b.replace(/xmlns=\"http:\/\/www\.w3\.org\/2000\/svg\"/, ""), canvg(a, b), $(a).insertAfter(this), $(this).attr("class", "tempHide"), $(this).hide() }), f(), $.each(document.find(".screenShotTempCanvas"), function () { $(this).remove() }), $.each(document.find(".tempHide"), function () { $(this).show().removeClass("tempHide") }) }) });